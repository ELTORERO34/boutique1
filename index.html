<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>NEXA MARKET</title>
  <style>
    /* ------------------------------
       THEME SOMBRE + VERT PREMIUM
    ------------------------------ */
    :root {
      --bg: #05060a;
      --bg-soft: #090b12;
      --card: rgba(16, 18, 28, 0.96);
      --card-soft: rgba(20, 24, 36, 0.9);
      --border: rgba(255, 255, 255, 0.06);
      --text: #f5f7fb;
      --muted: #8d99ab;
      --accent: #18c974;
      --accent-soft: rgba(24, 201, 116, 0.18);
      --accent-strong: #12a35c;
      --danger: #ff4d5a;
      --shadow-soft: 0 14px 30px rgba(0, 0, 0, 0.65);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #151927 0%, #05060a 55%, #020308 100%);
      color: var(--text);
      overflow: hidden;
    }

    #app {
      height: 100vh;
      max-width: 520px;
      margin: 0 auto;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    /* ------------------------------
       HEADER
    ------------------------------ */
    .header {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 520px;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 16px;
      background: linear-gradient(
        to bottom,
        rgba(5, 6, 10, 0.96),
        rgba(5, 6, 10, 0.9)
      );
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      z-index: 20;
    }

    .header-btn {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 6px 12px;
      font-size: 13px;
      color: var(--muted);
      background: rgba(7, 9, 16, 0.9);
    }

    .header-title {
      flex: 1;
      text-align: center;
      font-weight: 800;
      font-size: 18px;
      letter-spacing: 0.08em;
      color: var(--text);
      text-transform: uppercase;
    }

    .header-icon {
      width: 32px;
      text-align: right;
      color: var(--muted);
      font-size: 20px;
    }

    /* ------------------------------
       VIEWS
    ------------------------------ */
    .view {
      position: absolute;
      top: 64px;
      left: 0;
      right: 0;
      bottom: 76px;
      padding: 16px;
      overflow-y: auto;
      display: none;
    }

    .view.active {
      display: block;
    }

    /* ------------------------------
       NAVBAR BAS
    ------------------------------ */
    .navbar-wrapper {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 10px;
      width: 100%;
      max-width: 520px;
      display: flex;
      justify-content: center;
      z-index: 30;
      pointer-events: none;
    }

    .navbar {
      pointer-events: auto;
      width: 96%;
      max-width: 480px;
      height: 58px;
      background: rgba(10, 12, 20, 0.98);
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: space-around;
      padding: 0 6px;
    }

    .nav-item {
      flex: 1;
      height: 40px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      color: var(--muted);
      font-size: 11px;
      border: none;
      background: transparent;
      position: relative;
    }

    .nav-item span.icon {
      font-size: 18px;
    }

    .nav-item span.label {
      display: none; /* t√©l√©phone : seulement ic√¥ne */
    }

    .nav-item.active {
      background: radial-gradient(circle at top, var(--accent-soft), transparent);
      color: var(--accent);
      font-weight: 600;
    }

    .nav-item.active::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      border: 1px solid rgba(24, 201, 116, 0.65);
      box-shadow: 0 0 12px rgba(24, 201, 116, 0.4);
    }

    /* ------------------------------
       UTILITAIRES
    ------------------------------ */
    .muted {
      color: var(--muted);
    }

    h2 {
      font-size: 20px;
      margin-bottom: 8px;
    }

    h3 {
      font-size: 16px;
      margin-bottom: 6px;
    }

    /* ------------------------------
       MENU : BRAND + BOUTONS FILTRES
    ------------------------------ */
    .brand-block {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 14px;
    }

    .brand-logo {
      width: 46px;
      height: 46px;
      border-radius: 16px;
      background: radial-gradient(circle at top, #1ff28a, #0c3b25);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 18px;
      color: #02110a;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.7);
    }

    .brand-text-main {
      font-weight: 700;
      font-size: 18px;
    }

    .brand-text-sub {
      font-size: 12px;
      color: var(--muted);
    }

    .filter-row-top {
      display: flex;
      gap: 10px;
      margin-bottom: 16px;
    }

    .filter-pill {
      flex: 1;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--card-soft);
      padding: 8px 10px;
      font-size: 13px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      color: var(--muted);
    }

    .filter-pill .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--border);
    }

    .filter-pill.active {
      border-color: var(--accent);
      color: var(--accent);
      background: radial-gradient(circle at top, var(--accent-soft), #101624);
    }

    .filter-pill.active .dot {
      background: var(--accent);
      box-shadow: 0 0 8px rgba(24, 201, 116, 0.7);
    }

    /* ------------------------------
       GRID PRODUITS
    ------------------------------ */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 14px;
      padding-bottom: 10px;
    }

    .product-card {
      border-radius: 18px;
      background: var(--card);
      border: 1px solid var(--border);
      padding: 8px;
      box-shadow: 0 14px 24px rgba(0, 0, 0, 0.7);
      position: relative;
      overflow: hidden;
    }

    .product-img {
      width: 100%;
      height: 140px;
      border-radius: 14px;
      background-size: cover;
      background-position: center;
      background-color: #15192a;
      margin-bottom: 8px;
    }

    .product-badges {
      position: absolute;
      top: 10px;
      left: 10px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      z-index: 2;
    }

    .badge-chip {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(7, 9, 16, 0.88);
      border: 1px solid rgba(255, 255, 255, 0.16);
      color: var(--text);
    }

    .badge-chip.accent {
      border-color: var(--accent);
      color: #b6ffda;
    }

    .product-name {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .product-sub {
      font-size: 11px;
      color: var(--muted);
    }

    /* ------------------------------
       FICHE PRODUIT
    ------------------------------ */
    .product-hero {
      width: 100%;
      height: 220px;
      border-radius: 22px;
      background-size: cover;
      background-position: center;
      background-color: #171b2a;
      margin-bottom: 14px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 16px 26px rgba(0, 0, 0, 0.85);
    }

    .product-hero-overlay {
      position: absolute;
      inset: auto 0 0 0;
      padding: 10px 14px 14px;
      background: linear-gradient(
        to top,
        rgba(3, 5, 9, 0.96),
        rgba(3, 5, 9, 0.25),
        transparent
      );
    }

    .product-hero-title {
      font-size: 16px;
      font-weight: 700;
    }

    .product-hero-sub {
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .tag-badge {
      font-size: 11px;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(12, 16, 26, 0.9);
      color: var(--muted);
    }

    .tag-badge.accent {
      border-color: var(--accent);
      color: #b5ffd7;
    }

    .card {
      border-radius: 18px;
      background: var(--card);
      border: 1px solid var(--border);
      padding: 14px;
      margin-bottom: 14px;
      box-shadow: var(--shadow-soft);
    }

    .btn-primary {
      width: 100%;
      padding: 10px 12px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #021208;
      font-weight: 700;
      font-size: 14px;
      margin-top: 8px;
    }

    /* ------------------------------
       PANIER / COMMANDES
    ------------------------------ */
    .tab-bar {
      display: flex;
      gap: 8px;
      margin-bottom: 14px;
    }

    .tab {
      flex: 1;
      padding: 8px;
      border-radius: 999px;
      font-size: 13px;
      text-align: center;
      background: rgba(14, 16, 24, 0.9);
      border: 1px solid var(--border);
      color: var(--muted);
    }

    .tab.active {
      background: radial-gradient(circle at top, var(--accent-soft), #151c2a);
      color: var(--accent);
      border-color: var(--accent);
      font-weight: 600;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 8px;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.06);
      font-size: 13px;
    }

    .order-card {
      border-radius: 14px;
      background: var(--card-soft);
      border: 1px solid var(--border);
      padding: 10px 12px;
      margin-bottom: 10px;
      font-size: 13px;
    }

    /* ------------------------------
       INFOS / AVIS / CONTACT
    ------------------------------ */
    .info-block {
      margin-bottom: 14px;
    }

    .info-label {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 2px;
    }

    .info-value {
      font-size: 14px;
    }

    .contact-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.07);
      font-size: 13px;
    }

    .contact-row:last-child {
      border-bottom: none;
    }

    /* ------------------------------
       PANNEAU DE FILTRES (BOTTOM SHEET)
    ------------------------------ */
    .filter-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      display: none;
      align-items: flex-end;
      justify-content: center;
      z-index: 40;
    }

    .filter-overlay.show {
      display: flex;
    }

    .filter-sheet {
      width: 100%;
      max-width: 520px;
      border-radius: 18px 18px 0 0;
      background: #06070d;
      border-top: 1px solid var(--border);
      box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.8);
      padding: 12px 16px 16px;
      max-height: 80vh;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .filter-sheet-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .filter-title {
      font-size: 15px;
      font-weight: 600;
    }

    .filter-action {
      font-size: 12px;
      color: var(--accent);
    }

    .filter-list {
      flex: 1;
      overflow-y: auto;
      padding-right: 4px;
      margin-top: 4px;
      margin-bottom: 10px;
    }

    .filter-row {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 2px;
      font-size: 14px;
      color: var(--text);
    }

    .filter-row input {
      accent-color: var(--accent);
      width: 18px;
      height: 18px;
    }

    .filter-footer-btn {
      width: 100%;
      padding: 10px 12px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #021208;
      font-weight: 700;
      font-size: 14px;
    }
    
    /* Sections internes dans les cartes Infos */
.info-section {
  margin-bottom: 14px;
}

.info-section:last-child {
  margin-bottom: 0;
}

.info-section-title {
  font-weight: 600;
  margin-bottom: 4px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.info-section-title span.icon {
  font-size: 14px;
}

.info-section-list {
  list-style: none;
  padding-left: 0;
  margin: 0;
}

.info-section-list li {
  font-size: 13px;
  color: var(--muted);
}

    /* POPUP GRAMMAGE */
.gram-popup {
    position: fixed;
    bottom: -100%;
    left: 0;
    width: 100%;
    background: rgba(20,20,20,0.92);
    backdrop-filter: blur(18px);
    border-top-left-radius: 22px;
    border-top-right-radius: 22px;
    padding: 18px;
    transition: 0.35s ease;
    z-index: 999;
}

.gram-popup.active {
    bottom: 0;
}

.gram-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.gram-title {
    color: white;
    font-size: 18px;
    font-weight: 700;
}

.gram-close {
    color: #888;
    font-size: 20px;
    cursor: pointer;
}

.gram-options {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.gram-option {
    padding: 10px 14px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.15);
    color: white;
    background: rgba(255,255,255,0.05);
    cursor: pointer;
    font-size: 14px;
    transition: 0.2s;
}

.gram-option.active {
    background: #00c86f;
    border-color: #00c86f;
}

.gram-qty {
    margin-top: 20px;
    text-align: center;
}

.qty-label {
    color: #ccc;
    margin-bottom: 8px;
}

.qty-box {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 18px;
    margin-bottom: 15px;
}

.qty-btn {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: rgba(255,255,255,0.1);
    border: none;
    color: white;
    font-size: 24px;
}

.qty-value {
    color: white;
    font-size: 20px;
    min-width: 30px;
    text-align: center;
}

.btn-validate {
    width: 100%;
    padding: 13px;
    border: none;
    background: #00c86f;
    border-radius: 14px;
    color: black;
    font-weight: 700;
    font-size: 16px;
}
  </style>
</head>
<body>
<div id="app">

  <!-- HEADER -->
  <div class="header">
    <button class="header-btn" onclick="navigate('menu')">Fermer</button>
    <div class="header-title" id="headerTitle">NEXA MARKET</div>
    <div class="header-icon">‚ãØ</div>
  </div>

  <!-- VIEW : MENU -->
  <div id="view-menu" class="view active">
    <div class="brand-block">
      <div class="brand-logo">NM</div>
      <div>
        <div class="brand-text-main">NEXA MARKET</div>
        <div class="brand-text-sub">S√©lection botanique ‚Äî Template</div>
      </div>
    </div>

    <div class="filter-row-top">
      <button class="filter-pill" id="btnFilterFarms"
              onclick="openFilterSheet('farms')">
        <span class="dot"></span>
        FARMS
      </button>
      <button class="filter-pill" id="btnFilterCategories"
              onclick="openFilterSheet('categories')">
        <span class="dot"></span>
        CAT√âGORIES
      </button>
    </div>

    <div class="product-grid" id="productGrid"></div>
  </div>

  <!-- VIEW : PRODUIT -->
  <div id="view-product" class="view">
    <div class="product-hero" id="productHero">
      <div class="product-hero-overlay">
        <div class="product-hero-title" id="productHeroName"></div>
        <div class="product-hero-sub" id="productHeroMeta"></div>
        <div class="badge-row" id="productHeroBadges"></div>
      </div>
    </div>

    <div class="card">
      <h3>Description</h3>
      <p class="muted" id="productDesc"></p>
      <button class="btn-primary" onclick="openGramPopup(currentProduct)">
        Choisir le grammage
      </button>
    </div>
    </div>
  
  <!-- POPUP SELECTION GRAMMAGE -->
<div id="gramPopup" class="gram-popup">
    <div class="gram-header">
        <div class="gram-title" id="gramProductName">S√©lection</div>
        <div class="gram-close" onclick="closeGramPopup()">‚úï</div>
    </div>

    <div id="gramOptions" class="gram-options"></div>
    <!-- SECTION QUANTIT√â -->
    <div id="gramQuantitySection" class="gram-qty" style="display:none;">
        <div class="qty-label" id="gramSelectedLabel">Choix s√©lectionn√©</div>
        <div class="qty-box">
            <button class="qty-btn" onclick="qtyMinus()">‚àí</button>
            <div class="qty-value" id="qtyValue">1</div>
            <button class="qty-btn" onclick="qtyPlus()">+</button>
        </div>
        <button class="btn-validate" onclick="validateGramChoice()">Valider</button>
    </div>
</div>

  <!-- VIEW : PANIER -->
  <div id="view-cart" class="view">
    <div class="tab-bar">
      <button class="tab active" onclick="switchCartTab('cart')">Panier</button>
      <button class="tab" onclick="switchCartTab('orders')">Commandes</button>
    </div>

    <div id="cartView">
      <div class="card" id="cartList"></div>
    </div>
    <div id="ordersView" style="display:none;">
      <div class="card" id="orderList"></div>
    </div>
  </div>

<!-- VIEW : INFOS -->
<div id="view-infos" class="view">
  <div class="tab-bar">
    <button class="tab active" onclick="switchInfosTab('envoi')">Envoi</button>
    <button class="tab" onclick="switchInfosTab('livraison')">Livraison</button>
    <button class="tab" onclick="switchInfosTab('meet')">Meet Up</button>
  </div>

  <!-- ONGLET ENVOI -->
  <div id="infos-envoi">
    <div class="card">
      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üìç</span>
          Localisation
        </div>
        <ul class="info-section-list">
          <li>- France M√©tropolitaine</li>
          <li>- D√©lai : 2-3 jours ouvr√©s</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">‚¨¢</span>
          Quantit√©s Minimum
        </div>
        <ul class="info-section-list">
          <li>- Minimum 50‚Ç¨</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üí≥</span>
          Mode de Paiement
        </div>
        <ul class="info-section-list">
          <li>- Cryptomonnaies (BTC, ETH, SOL)</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">‚ÑπÔ∏è</span>
          Infos Suppl√©mentaires
        </div>
        <ul class="info-section-list">
          <li>- Suivi disponible</li>
          <li>- Colis discret</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- ONGLET LIVRAISON -->
  <div id="infos-livraison" style="display:none;">
    <div class="card">
      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üìç</span>
          Localisation
        </div>
        <ul class="info-section-list">
          <li>- D√©partements : 69 / 01 / 38 / 74 / 73 / 43 / 42 / 26</li>
          <li>- Frais suppl√©mentaires √† pr√©voir pour les d√©partements voisins</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">‚¨¢</span>
          Quantit√©s Minimum
        </div>
        <ul class="info-section-list">
          <li>- Minimum 50‚Ç¨</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üí≥</span>
          Mode de Paiement
        </div>
        <ul class="info-section-list">
          <li>- Bitcoin (BTC)</li>
          <li>- Esp√®ces et cryptomonnaies</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üïí</span>
          Horaires
        </div>
        <ul class="info-section-list">
          <li>- 1√®re tourn√©e : 14h</li>
          <li>- 2√®me tourn√©e : 17h</li>
          <li>- 3√®me tourn√©e : 20h</li>
          <li>- 4√®me tourn√©e : 22h30</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- ONGLET MEET UP -->
  <div id="infos-meet" style="display:none;">
    <div class="card">
      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üìç</span>
          Localisation
        </div>
        <ul class="info-section-list">
          <li>- Lyon</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">‚¨¢</span>
          Quantit√©s Minimum
        </div>
        <ul class="info-section-list">
          <li>- Minimum 50‚Ç¨</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üí≥</span>
          Mode de Paiement
        </div>
        <ul class="info-section-list">
          <li>- Bitcoin (BTC)</li>
          <li>- Esp√®ces et cryptomonnaies</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">üïí</span>
          Horaires
        </div>
        <ul class="info-section-list">
          <li>- Tous les jours 14h‚Äì23h</li>
        </ul>
      </div>

      <div class="info-section">
        <div class="info-section-title">
          <span class="icon">‚ÑπÔ∏è</span>
          Infos Suppl√©mentaires
        </div>
        <ul class="info-section-list">
          <li>- Pour plus d'infos : @contact_exemple (Telegram/Snapchat)</li>
        </ul>
      </div>
    </div>
  </div>
</div>

  <!-- VIEW : AVIS -->
  <div id="view-avis" class="view">
    <h2>Avis</h2>
    <div class="card">
      <p class="muted">Avis clients d‚Äôexemple pour la boutique (√† modifier).</p>
    </div>
  </div>

  <!-- VIEW : CONTACT -->
  <div id="view-contact" class="view">
    <h2>Contact</h2>
    <div class="card">
      <div class="contact-row">
        <span>Email</span><span class="muted">example@mail.com</span>
      </div>
      <div class="contact-row">
        <span>Telegram</span><span class="muted">@username</span>
      </div>
      <div class="contact-row">
        <span>Instagram</span><span class="muted">@nexamarket</span>
      </div>
    </div>
  </div>

  <!-- NAVBAR -->
  <div class="navbar-wrapper">
    <div class="navbar">
      <button class="nav-item active" data-view="menu" onclick="navigate('menu')">
        <span class="icon">üè†</span>
      </button>
      <button class="nav-item" data-view="cart" onclick="navigate('cart')">
        <span class="icon">üõí</span>
      </button>
      <button class="nav-item" data-view="infos" onclick="navigate('infos')">
        <span class="icon">‚ÑπÔ∏è</span>
      </button>
      <button class="nav-item" data-view="avis" onclick="navigate('avis')">
        <span class="icon">‚≠ê</span>
      </button>
      <button class="nav-item" data-view="contact" onclick="navigate('contact')">
        <span class="icon">‚úâÔ∏è</span>
      </button>
    </div>
  </div>

  <!-- OVERLAY FILTRES -->
  <div class="filter-overlay" id="filterOverlay" onclick="overlayBgClick(event)">
    <div class="filter-sheet" id="filterSheet">
      <div class="filter-sheet-header">
        <div class="filter-title" id="filterTitle">Filtres</div>
        <button class="filter-action" onclick="clearFilterSelection()">Tout effacer</button>
      </div>
      <div class="filter-list" id="filterList"></div>
      <button class="filter-footer-btn" onclick="applyFilters()">Appliquer les filtres</button>
    </div>
  </div>

</div>

<script>
  /* ------------------------------
     DONN√âES : FARMS / CAT√âGORIES
  ------------------------------ */
  const FARMS = [
    "NeoFarm",
    "BioPeak",
    "MountainPrime",
    "FreshOrigin",
    "UrbanBloom",
    "SunLeaf Co",
    "NaturePro",
    "LeafLine",
    "EarthGrown",
    "GreenSphere"
  ];

  const CATEGORIES = [
    "Premium",
    "Indoor",
    "Greenhouse",
    "Botanique",
    "Edition Limit√©e",
    "S√©lection Visuelle",
    "S√©lection Aromatique",
    "Mixed Pack",
    "Fresh Pack",
    "Best Sellers"
  ];

const PRODUCTS = [
  {
    id: 1,
    name: "Green Leaf 01",
    desc: "Produit d'exemple neutre, s√©lection botanique.",
    img: "https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=600&q=80",
    farm: "NeoFarm",
    category: "Premium",
    grams: [
      { label: "3.5g", price: 25 },
      { label: "7g",   price: 45 },
      { label: "14g",  price: 80 }
    ]
  },

  {
    id: 2,
    name: "Nature Pack",
    desc: "Pack botanique s√©lection visuelle.",
    img: "https://images.unsplash.com/photo-1484557985045-edf25e08da73?auto=format&fit=crop&w=600&q=80",
    farm: "BioPeak",
    category: "Mixed Pack",
    grams: [
      { label: "5g",  price: 32 },
      { label: "10g", price: 59 },
      { label: "20g", price: 110 }
    ]
  },

  {
    id: 3,
    name: "Deep Bloom",
    desc: "Texture florale dense, √©dition limit√©e.",
    img: "https://images.unsplash.com/photo-1501004318641-68f74f7d47a1?auto=format&fit=crop&w=600&q=80",
    farm: "MountainPrime",
    category: "Edition Limit√©e",
    grams: [
      { label: "3g",  price: 22 },
      { label: "6g",  price: 40 },
      { label: "12g", price: 75 }
    ]
  },

  {
    id: 4,
    name: "Fresh Origin #2",
    desc: "S√©lection fra√Æche premium.",
    img: "https://images.unsplash.com/photo-1457530378978-8bac673b8062?auto=format&fit=crop&w=600&q=80",
    farm: "FreshOrigin",
    category: "Fresh Pack",
    grams: [
      { label: "5g",  price: 28 },
      { label: "10g", price: 52 },
      { label: "20g", price: 98 }
    ]
  },

  {
    id: 5,
    name: "Urban Bloom Prime",
    desc: "S√©rie botanique s√©lection aromatique.",
    img: "https://images.unsplash.com/photo-1466690672306-5f92a57251cb?auto=format&fit=crop&w=600&q=80",
    farm: "UrbanBloom",
    category: "S√©lection Aromatique",
    grams: [
      { label: "4g",  price: 30 },
      { label: "8g",  price: 56 },
      { label: "16g", price: 105 }
    ]
  },

  {
    id: 6,
    name: "SunLeaf Natural",
    desc: "√âdition botanique solaire.",
    img: "https://images.unsplash.com/photo-1497034825429-c343d7c6a68f?auto=format&fit=crop&w=600&q=80",
    farm: "SunLeaf Co",
    category: "Botanique",
    grams: [
      { label: "3g",  price: 20 },
      { label: "6g",  price: 38 },
      { label: "12g", price: 70 }
    ]
  },

  {
    id: 7,
    name: "NaturePro Select",
    desc: "S√©lection visuelle premium.",
    img: "https://images.unsplash.com/photo-1501004318641-9e8e4cdf06ae?auto=format&fit=crop&w=600&q=80",
    farm: "NaturePro",
    category: "S√©lection Visuelle",
    grams: [
      { label: "5g",  price: 35 },
      { label: "10g", price: 60 },
      { label: "20g", price: 115 }
    ]
  },

  {
    id: 8,
    name: "LeafLine Pure",
    desc: "Produit naturel haute qualit√©.",
    img: "https://images.unsplash.com/photo-1438109491414-7198515b166b?auto=format&fit=crop&w=600&q=80",
    farm: "LeafLine",
    category: "Indoor",
    grams: [
      { label: "3.5g", price: 24 },
      { label: "7g",   price: 42 },
      { label: "14g",  price: 78 }
    ]
  },

  {
    id: 9,
    name: "EarthGrown Zenith",
    desc: "Best seller naturel revisit√©.",
    img: "https://images.unsplash.com/photo-1501004318641-b39de8e27db7?auto=format&fit=crop&w=600&q=80",
    farm: "EarthGrown",
    category: "Best Sellers",
    grams: [
      { label: "4g",  price: 29 },
      { label: "8g",  price: 55 },
      { label: "15g", price: 108 }
    ]
  },

  {
    id: 10,
    name: "GreenSphere 01",
    desc: "Lot botanique √©quilibr√©.",
    img: "https://images.unsplash.com/photo-1497034825429-c343d7c6a68f?auto=format&fit=crop&w=600&q=80",
    farm: "GreenSphere",
    category: "Greenhouse",
    grams: [
      { label: "5g",  price: 27 },
      { label: "10g", price: 50 },
      { label: "20g", price: 95 }
    ]
  },

  {
    id: 11,
    name: "Origin Flora",
    desc: "S√©lection nature polyvalente.",
    img: "https://images.unsplash.com/photo-1457530378978-8bac673b8062?auto=format&fit=crop&w=600&q=80",
    farm: "FreshOrigin",
    category: "Botanique",
    grams: [
      { label: "5g", price: 30 },
      { label: "10g", price: 57 },
      { label: "18g", price: 105 }
    ]
  },

  {
    id: 12,
    name: "Bloom Edition",
    desc: "√âdition limit√©e s√©lection visuelle.",
    img: "https://images.unsplash.com/photo-1484557985045-edf25e08da73?auto=format&fit=crop&w=600&q=80",
    farm: "MountainPrime",
    category: "Edition Limit√©e",
    grams: [
      { label: "4g",  price: 28 },
      { label: "8g",  price: 53 },
      { label: "15g", price: 100 }
    ]
  }
];

  /* ------------------------------
     ETAT FILTRES
  ------------------------------ */
  let activeFarms = new Set();
  let activeCategories = new Set();
  let currentFilterType = null;
  let tempSelection = new Set();

  /* ------------------------------
     ETAT PRODUIT / PANIER
  ------------------------------ */
  let CART = [];
  let ORDERS = [];

  /* ------------------------------
     RENDER PRODUITS + FILTRES
  ------------------------------ */
  function productMatchesFilters(p) {
    const farmOK = activeFarms.size === 0 || activeFarms.has(p.farm);
    const catOK = activeCategories.size === 0 || activeCategories.has(p.category);
    return farmOK && catOK;
  }

  function renderProducts() {
    const grid = document.getElementById("productGrid");
    grid.innerHTML = "";
    const filtered = PRODUCTS.filter(productMatchesFilters);

    if (filtered.length === 0) {
      grid.innerHTML = `<div class="muted" style="grid-column: 1 / -1; text-align:center; padding:30px 0;">
        Aucun produit ne correspond aux filtres.
      </div>`;
      return;
    }

    filtered.forEach(p => {
      const card = document.createElement("div");
      card.className = "product-card";
      card.onclick = () => openProduct(p.id);

      const badges = document.createElement("div");
      badges.className = "product-badges";
      const farmBadge = document.createElement("div");
      farmBadge.className = "badge-chip accent";
      farmBadge.textContent = p.farm;
      const catBadge = document.createElement("div");
      catBadge.className = "badge-chip";
      catBadge.textContent = p.category;
      badges.appendChild(farmBadge);
      badges.appendChild(catBadge);

      const img = document.createElement("div");
      img.className = "product-img";
      img.style.backgroundImage = `url('${p.img}')`;

      const nameEl = document.createElement("div");
      nameEl.className = "product-name";
      nameEl.textContent = p.name;

      const subEl = document.createElement("div");
      subEl.className = "product-sub";
      subEl.textContent = "Collection botanique";

      card.appendChild(badges);
      card.appendChild(img);
      card.appendChild(nameEl);
      card.appendChild(subEl);

      grid.appendChild(card);
    });

    updateFilterButtonsState();
  }

  /* ------------------------------
     NAVIGATION
  ------------------------------ */
  function navigate(view) {
    document.querySelectorAll(".view").forEach(v => v.classList.remove("active"));
    document.getElementById("view-" + view).classList.add("active");

    document.querySelectorAll(".nav-item").forEach(btn => {
      btn.classList.remove("active");
      if (btn.dataset.view === view) {
        btn.classList.add("active");
      }
    });

    const titles = {
      menu: "NEXA MARKET",
      cart: "Panier",
      infos: "Informations",
      avis: "Avis",
      contact: "Contact",
      product: "Produit"
    };
    document.getElementById("headerTitle").textContent = titles[view] || "NEXA MARKET";
  }

  /* ------------------------------
     FICHE PRODUIT
  ------------------------------ */
  function openProduct(id) {
    const p = PRODUCTS.find(x => x.id === id);
    if (!p) return;
    currentProduct = p;

    const hero = document.getElementById("productHero");
    hero.style.backgroundImage = `url('${p.img}')`;

    document.getElementById("productHeroName").textContent = p.name;
    document.getElementById("productHeroMeta").textContent = `${p.farm} ‚Ä¢ ${p.category}`;
    const badges = document.getElementById("productHeroBadges");
    badges.innerHTML = "";
    [p.farm, p.category].forEach((b, idx) => {
      const div = document.createElement("div");
      div.className = "tag-badge" + (idx === 0 ? " accent" : "");
      div.textContent = b;
      badges.appendChild(div);
    });

    document.getElementById("productDesc").textContent = p.desc;

    navigate("product");
  }

  /* ------------------------------
     PANIER / COMMANDES
  ------------------------------ */
  function addToCart() {
    if (!currentProduct) return;
    CART.push(currentProduct);
    renderCart();
    navigate("cart");
  }

function renderCart() {
  const container = document.getElementById("cartList");
  if (!container) return;

  if (CART.length === 0) {
    container.innerHTML = `<div class="muted">Votre panier est vide.</div>`;
    return;
  }

  let total = 0;
  let html = "";

  CART.forEach((item, index) => {
    const lineTotal = item.price * item.qty;
    total += lineTotal;

    html += `
      <div class="cart-item">
        <div>
          <strong>${item.name}</strong><br />
          <span class="muted" style="font-size:12px;">
            ${item.gram} ‚Ä¢ ${item.farm} ‚Ä¢ ${item.category}
          </span>
        </div>
        <div style="text-align:right;">
          <div style="font-size:13px;">${lineTotal}‚Ç¨</div>
          <button class="header-btn"
                  style="font-size:11px;margin-top:4px;"
                  onclick="removeFromCart(${index})">
            Retirer
          </button>
        </div>
      </div>
    `;
  });

  html += `
    <div style="text-align:right;margin-top:8px;font-size:13px;">
      <strong>Total : ${total}‚Ç¨</strong>
    </div>
    <button class="btn-primary" style="margin-top:10px;"
            onclick="validateOrder()">
      Valider la commande
    </button>
  `;

  container.innerHTML = html;
}

  function removeFromCart(index) {
    CART.splice(index, 1);
    renderCart();
  }

  function validateOrder() {
    if (CART.length === 0) return;
    ORDERS.push([...CART]);
    CART = [];
    renderCart();
    renderOrders();
    switchCartTab("orders");
  }

  function renderOrders() {
    const container = document.getElementById("orderList");
    if (ORDERS.length === 0) {
      container.innerHTML = `<div class="muted">Aucune commande pour le moment.</div>`;
      return;
    }

    let html = "";
    ORDERS.forEach((order, idx) => {
      html += `<div class="order-card"><strong>Commande #${idx + 1}</strong><br />`;
      order.forEach(p => {
        html += `<div class="muted">${p.name} ‚Äî ${p.farm} / ${p.category}</div>`;
      });
      html += `</div>`;
    });
    container.innerHTML = html;
  }

  function switchCartTab(tab) {
    const cartTab = document.querySelector("#view-cart .tab:nth-child(1)");
    const orderTab = document.querySelector("#view-cart .tab:nth-child(2)");
    if (tab === "cart") {
      cartTab.classList.add("active");
      orderTab.classList.remove("active");
      document.getElementById("cartView").style.display = "block";
      document.getElementById("ordersView").style.display = "none";
    } else {
      cartTab.classList.remove("active");
      orderTab.classList.add("active");
      document.getElementById("cartView").style.display = "none";
      document.getElementById("ordersView").style.display = "block";
      renderOrders();
    }
  }

  /* ------------------------------
     INFOS TABS
  ------------------------------ */
  function switchInfosTab(tab) {
    const tabs = document.querySelectorAll("#view-infos .tab");
    tabs.forEach(btn => btn.classList.remove("active"));
    if (tab === "envoi") tabs[0].classList.add("active");
    if (tab === "livraison") tabs[1].classList.add("active");
    if (tab === "meet") tabs[2].classList.add("active");

    document.getElementById("infos-envoi").style.display = tab === "envoi" ? "block" : "none";
    document.getElementById("infos-livraison").style.display = tab === "livraison" ? "block" : "none";
    document.getElementById("infos-meet").style.display = tab === "meet" ? "block" : "none";
  }

  /* ------------------------------
     PANNEAU DE FILTRES
  ------------------------------ */
  function openFilterSheet(type) {
    currentFilterType = type;
    tempSelection = new Set(type === "farms" ? activeFarms : activeCategories);

    const title = document.getElementById("filterTitle");
    title.textContent = type === "farms" ? "Farms" : "Cat√©gories";

    const list = document.getElementById("filterList");
    list.innerHTML = "";

    const source = type === "farms" ? FARMS : CATEGORIES;
    source.forEach(name => {
      const row = document.createElement("label");
      row.className = "filter-row";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.checked = tempSelection.has(name);
      checkbox.addEventListener("change", () => {
        if (checkbox.checked) tempSelection.add(name);
        else tempSelection.delete(name);
      });

      const span = document.createElement("span");
      span.textContent = name;

      row.appendChild(checkbox);
      row.appendChild(span);
      list.appendChild(row);
    });

    document.getElementById("filterOverlay").classList.add("show");
  }

  function closeFilterSheet() {
    document.getElementById("filterOverlay").classList.remove("show");
    currentFilterType = null;
    tempSelection.clear();
  }

  function overlayBgClick(e) {
    if (e.target.id === "filterOverlay") {
      closeFilterSheet();
    }
  }

  function clearFilterSelection() {
    tempSelection.clear();
    document.querySelectorAll("#filterList input[type='checkbox']").forEach(cb => {
      cb.checked = false;
    });
  }

  function applyFilters() {
    if (!currentFilterType) return;
    if (currentFilterType === "farms") {
      activeFarms = new Set(tempSelection);
    } else {
      activeCategories = new Set(tempSelection);
    }
    closeFilterSheet();
    renderProducts();
  }

  function updateFilterButtonsState() {
    const farmsBtn = document.getElementById("btnFilterFarms");
    const catBtn = document.getElementById("btnFilterCategories");

    farmsBtn.classList.toggle("active", activeFarms.size > 0);
    catBtn.classList.toggle("active", activeCategories.size > 0);
  }

  /* ------------------------------
     INIT
  ------------------------------ */
  renderProducts();
  renderCart();
  
      let currentProduct = null;
let selectedGram = null;
let qty = 1;

/* OUVRIR LE POPUP DE GRAMMAGE */
function openGramPopup(product) {
    currentProduct = product;
    selectedGram = null;
    qty = 1;

    document.getElementById("gramProductName").textContent = product.name;
    document.getElementById("qtyValue").textContent = qty;

    const container = document.getElementById("gramOptions");
    container.innerHTML = "";

    product.grams.forEach(g => {
        const btn = document.createElement("div");
        btn.className = "gram-option";
        btn.textContent = `${g.price}‚Ç¨ ‚Äî ${g.label}`;
        btn.onclick = () => selectGram(g, btn);
        container.appendChild(btn);
    });

    document.getElementById("gramQuantitySection").style.display = "none";
    document.getElementById("gramPopup").classList.add("active");
}

/* FERMER */
function closeGramPopup() {
    document.getElementById("gramPopup").classList.remove("active");
}

/* SELECTIONNER LE GRAMMAGE */
function selectGram(gram, btn) {
    selectedGram = gram;

    document.querySelectorAll(".gram-option").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    document.getElementById("gramSelectedLabel").textContent = `${gram.price}‚Ç¨ ‚Äî ${gram.label}`;
    document.getElementById("gramQuantitySection").style.display = "block";
}

/* QUANTIT√â */
function qtyPlus() { qty++; document.getElementById("qtyValue").textContent = qty; }
function qtyMinus() { if(qty > 1){ qty--; document.getElementById("qtyValue").textContent = qty; } }

/* VALIDER */
function validateGramChoice() {
  if (!currentProduct || !selectedGram) return;

  // On cr√©e un item de panier complet
  const item = {
    productId: currentProduct.id,
    name: currentProduct.name,
    farm: currentProduct.farm,
    category: currentProduct.category,
    gram: selectedGram.label,
    price: selectedGram.price,
    qty: qty
  };

  CART.push(item);

  // On met √† jour l‚Äôaffichage du panier
  renderCart();

  // On ferme le popup
  closeGramPopup();

  // On bascule sur l‚Äôonglet Panier
  navigate('cart');
}
</script>
</body>
</html>